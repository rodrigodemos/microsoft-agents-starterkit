# =============================================================================
# Azure OpenAI Configuration (Entra ID auth — no API keys)
# =============================================================================
# Authentication uses Entra ID: Managed Identity in production, Azure CLI locally.
# Ensure your identity has "Cognitive Services OpenAI User" role on the resource.
AZURE_OPENAI_ENDPOINT=https://<your-resource>.openai.azure.com
AZURE_OPENAI_DEPLOYMENT=gpt-4o-mini
AZURE_OPENAI_API_VERSION=2024-12-01-preview

# =============================================================================
# M365 / Teams Authentication (Entra ID app registration)
# =============================================================================
# App registration for the agent — used for M365 channel authentication
CLIENT_ID=
TENANT_ID=

# =============================================================================
# SSO / On-Behalf-Of (OBO) — User identity flows through to tools
# =============================================================================
# Auth handler must be AGENTIC for SSO/OBO to work end-to-end:
# User → Teams → M365 → Orchestrator → Tools (all delegated access)
AUTH_HANDLER_NAME=AGENTIC

# =============================================================================
# Agent 365 Agentic Authentication (SSO / OBO)
# =============================================================================
# Service connection for the agent's Entra ID app registration
CONNECTIONS__SERVICE_CONNECTION__SETTINGS__CLIENTID=
CONNECTIONS__SERVICE_CONNECTION__SETTINGS__TENANTID=
CONNECTIONS__SERVICE_CONNECTION__SETTINGS__SCOPES=

# User authorization handler — enables OBO token exchange for delegated access
AGENTAPPLICATION__USERAUTHORIZATION__HANDLERS__AGENTIC__SETTINGS__TYPE=AgenticUserAuthorization
AGENTAPPLICATION__USERAUTHORIZATION__HANDLERS__AGENTIC__SETTINGS__SCOPES=https://graph.microsoft.com/.default
AGENTAPPLICATION__USERAUTHORIZATION__HANDLERS__AGENTIC__SETTINGS__ALTERNATEBLUEPRINTCONNECTIONNAME=https://graph.microsoft.com/.default

CONNECTIONSMAP_0_SERVICEURL=*
CONNECTIONSMAP_0_CONNECTION=SERVICE_CONNECTION

# =============================================================================
# Server Configuration
# =============================================================================
PORT=3978

# =============================================================================
# Observability
# =============================================================================
ENABLE_OBSERVABILITY=true
ENABLE_A365_OBSERVABILITY_EXPORTER=false
PYTHON_ENVIRONMENT=development
ENABLE_OTEL=true
ENABLE_SENSITIVE_DATA=true
OBSERVABILITY_SERVICE_NAME=agents-starterkit
OBSERVABILITY_SERVICE_NAMESPACE=agents-starterkit

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=INFO
